<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚¹ãƒ¯ã‚¤ãƒ—ï¼‹è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«</title>
<style>

  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100vh;
    font-family: "Hiragino Maru Gothic ProN", "Hiragino Maru Gothic Pro","Rounded Mplus 1c", "Yu Gothic Rounded", "Noto Sans JP", sans-serif;
  }

  .page {
    overflow-y: scroll;
    scroll-snap-type: y mandatory;
    scroll-behavior: smooth;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform: translateX(100%);
    transition: transform 0.4s ease;
    opacity: 0;
  }
  /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒšãƒ¼ã‚¸ã¯ä¸­å¤®ã« */
  .page.active {
    transform: translateX(0);
    opacity: 1;
  }
  .page.left {
    transform: translateX(-100%);
    opacity: 1;
  }
  .page.right {
    transform: translateX(100%);
    opacity: 1;
  }
  
  /* --- âœ… ä¸Šéƒ¨ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ --- */
  .title-bar {
    position: fixed;
    justify-content: center;
    top: 0;
    left: 0;
    width: 100%;
    height: 90px;
    background: #fff;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
    padding: 0 1rem;
    box-sizing: border-box;
    z-index: 30;
  }
  .title-bar.hidden {
    display: none;
  }

  /* ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ */
  .menu-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    width: 24px;
    height: 24px;
    margin-right: 1rem;
  }

  /* ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­— */
  .page-title {
    font-size: 1.2rem;
    font-weight: bold;
    color: #333;
    margin: 0;
  }

  /* ãƒšãƒ¼ã‚¸å†…å®¹ã¯ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã®ä¸‹ã‹ã‚‰å§‹ã¾ã‚‹ã‚ˆã†ã« */
  .page-content {
    padding-top: 90px;
    padding-bottom: 60px; /* ä¸‹ã®ã‚¿ãƒ–ãƒãƒ¼åˆ† */
    box-sizing: border-box;
  }
  
  .page-content img{
    width: 100%;
  }
  
  /* ãƒ›ãƒ¼ãƒ ç”»é¢ä¸‹éƒ¨ã®ç”»åƒ */
  .home-bottom {
    position: fixed;
    bottom: 70px;
    left: 0;
    width: 100%;
    z-index: 850;
    padding: 0 16px;
    box-sizing: border-box;
    transition: opacity 150ms ease;
  }
  .home-bottom img {
    max-width: 100%;
    height: auto;
  }
  .home-bottom #homeBottomToTicket {
    cursor: pointer;
  }
  
  /* ãƒã‚±ãƒƒãƒˆç®¡ç†ãƒšãƒ¼ã‚¸ã®å‹•ç”» */
  .ticket-animation {
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }

  /* ç¸¦ç”»é¢å‹•ç”» */
  .card {
    position: relative;
    height: 100vh;
    width: 100%;
    scroll-snap-align: start;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 2rem;
    transition: transform 0.4s ease, opacity 0.4s ease;
  }

  .card:nth-child(odd) { background: #ff4b5c; }
  .card:nth-child(even) { background: #2b2e4a; }

  .card:not(.active) {
    transform: scale(0.95);
    opacity: 0.7;
  }
  
  /* ç¸¦å‹•ç”» */
  .card .card-video {
    height: 100%;
  }

  /* ãƒ¢ãƒ¼ãƒ€ãƒ«ã®åŸºæœ¬æ§‹é€  */
  .modal {
    position: fixed;
    top: 0;
    right: -96%;
    width: 100%;
    height: 94vh;
    background: white;
    color: #757575;
    transition: right 0.4s ease;
    z-index: 10;
    border-top-left-radius: 16px;
    border-bottom-left-radius: 16px;
    overflow: hidden;
    box-shadow: -4px 0 10px rgba(0,0,0,0.2);
  }
  /* ğŸ‘‡ ã“ã“ãŒã€Œã¯ã¿å‡ºã—ã¦ã„ã‚‹éƒ¨åˆ†ã€ã«ç›¸å½“ã™ã‚‹ã‚¯ãƒªãƒƒã‚¯é ˜åŸŸ */
  .modal #modal-swipe-handle {
    position: absolute;
    top: 0;
    left: 0;
    width: 16px; /* â† å¥½ãã«èª¿æ•´ */
    height: 100%;
    cursor: pointer;
    /* ãƒ‡ãƒãƒƒã‚°ä¸­ã ã‘è‰²ã‚’ã¤ã‘ã‚‹ï¼ˆå®Œæˆæ™‚ã¯æ¶ˆã™ï¼‰ */
    background: rgba(255,0,0,0.2);
  }
  
  .modal.hidden {
    display: none;
  }

  .modal.open {
    right: 0;
  }
  
  .modal-content {
    padding-left: 16px;
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .modal-header {
    padding: 1rem;
    background: white;
    color: #757575;
    font-size: 1.2rem;
  }

  .close-btn {
    color: #757575;
    float: right;
    font-size: 1.2rem;
    cursor: pointer;
  }

  .info {
    position: absolute;
    bottom: calc(60px + env(safe-area-inset-bottom));
    left: calc(16px + env(safe-area-inset-left));
    font-size: 1.1rem;
    text-shadow: 0 0 8px rgba(0,0,0,0.6);
  }
  
  /* ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸ */
  .collection-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4px;
    padding: 4px;
  }
  .collection-grid img {
    width: 100%;
    border-radius: 4px;
    cursor: pointer;
  }

  /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ */
  .back-btn {
    position: fixed;
    top: 16px;
    left: 16px;
    background: rgba(0,0,0,0);
    color: white;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    font-size: 1.2rem;
    z-index: 20;
    cursor: pointer;
    display: none;
  }
  
  .back-btn.active {
    display: block;
  } 
  
  /* --- âœ… ãƒœãƒˆãƒ ã‚¿ãƒ–ãƒãƒ¼ --- */
  .tab-bar {
    position: fixed;
    bottom: 0;
    width: 100%;
    height: 60px;
    background: #fff;
    border-top: 1px solid #e0e0e0;
    display: flex;
    justify-content: space-around;
    align-items: flex-start;
    z-index: 20;
    padding-top: 0.2rem;
  }

  .tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 33.3%;
    font-size: 0.7rem;
    color: #757575;
    cursor: pointer;
  }

  .tab img {
    width: 22px;
    height: 22px;
    margin-bottom: 2px;
  }

  .tab.active {
    font-weight: bold;
  }

  .tab.active span {
    background: linear-gradient(to right, #FF54AF, #FF9A0B);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
</style>
</head>
<body>
  <!-- ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ -->
  <div class="title-bar" id="titleBar">
    <img src="https://kkkkame0721.github.io/demoApp/img/menu.svg" alt="menu" class="menu-icon" />
    <h1 class="page-title" id="pageTitle">ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼</h1>
  </div>
  
  <!-- ãƒ›ãƒ¼ãƒ ã‚¿ãƒ– -->
  <div class="page" id="home" data-tabname="ãƒ›ãƒ¼ãƒ ">
    <div class="page-content">
      <img src="https://kkkkame0721.github.io/demoApp/img/home_content.svg?ver=1.1" id="homeContent" />
    </div>
  </div>
  <!-- ãƒ›ãƒ¼ãƒ ã‚¿ãƒ–ä¸‹éƒ¨ã®å›ºå®šç”»åƒ -->
  <div class="home-bottom" id="homeBottom">
    <img src="https://kkkkame0721.github.io/demoApp/img/home_content_bottom_1.svg" id="homeBottomToTicket" />
    <img src="https://kkkkame0721.github.io/demoApp/img/home_content_bottom_2.svg" />
  </div>
  <!-- ãƒã‚±ãƒƒãƒˆã‚¿ãƒ– -->
  <div class="page" id="ticket" data-tabname="ãƒã‚±ãƒƒãƒˆç®¡ç†">
    <div class="page-content">
      <video class="ticket-animation" id="ticketAnimation" playsinline muted>
        <source src="https://kkkkame0721.github.io/demoApp/img/ticket_movie.mp4" type="video/mp4">
      </video>
    </div>
  </div>
  <!-- ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ãƒ– -->
  <div class="page" id="collection" data-tabname="ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³">
    <div class="page-content">
      <div class="collection-grid" id="collectionGrid">
      </div>
    </div>
  </div>
  <!-- ç¸¦å‹•ç”»ã‚¿ãƒ– -->
  <div class="page" id="scrollArea">
  </div>
  <button class="back-btn" id="backBtn">â†</button>
  
  <!-- è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal hidden" id="modal">
    <div id="modal-swipe-handle"></div> <!-- â† ã“ã“ãŒã‚¿ãƒƒãƒ—é ˜åŸŸ -->

    <div class="modal-content">
      <div class="modal-header">
        <span class="modal-title">è©³ç´°ãƒšãƒ¼ã‚¸</span>
        <span class="close-btn" id="closeModal">âœ•</span>
      </div>

      <div class="modal-body">

        <!-- â‘  ä¸Šéƒ¨ã®å¤§ãã„ç”»åƒ -->
        <div class="modal-hero">
          <img id="modalHeroImage" src="https://kkkkame0721.github.io/demoApp/img/full_ticket.svg" alt="ticket image">
        </div>

        <!-- â‘¡ ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="modal-section" id="eventSection">
          <h2 class="section-title">ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°</h2>

          <div class="event-content">
            <img id="eventImage" src="https://placehold.jp/360x120.png" alt="event thumbnail">
            <div class="event-text">
              <h3 id="eventTitle">ã‚¿ã‚¤ãƒˆãƒ«ãŒå…¥ã‚Šã¾ã™</h3>
              <p id="eventDate">æ—¥ä»˜ãŒå…¥ã‚Šã¾ã™</p>
              <p id="eventDescription">èª¬æ˜æ–‡ãŒå…¥ã‚Šã¾ã™</p>
            </div>
          </div>
        </section>

        <!-- â‘¢ è©³ç´°æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="modal-section" id="detailSection">
          <h2 class="section-title">è©³ç´°æƒ…å ±</h2>

          <p><strong>æ’®å½±å ´æ‰€ï¼š</strong><span id="eventLocation">æœªè¨­å®š</span></p>
          <p><strong>æ’®å½±æ—¥æ™‚ï¼š</strong><span id="eventRecordedAt">æœªè¨­å®š</span></p>
          <p><strong>ãƒ¡ãƒ¢ï¼š</strong><span id="eventNotes">ç‰¹ã«ãªã—</span></p>
        </section>

      </div>
    </div>
  </div>



  <!-- âœ… ãƒœãƒˆãƒ ãƒãƒ¼ -->
  <div class="tab-bar" id="tabBar">
    <div class="tab" data-tab="home">
      <img src="https://kkkkame0721.github.io/demoApp/icon/home.svg" alt="ãƒ›ãƒ¼ãƒ ">
      <span>ãƒ›ãƒ¼ãƒ </span>
    </div>
    <div class="tab" data-tab="ticket">
      <img src="https://kkkkame0721.github.io/demoApp/icon/ticket.svg" alt="ãƒã‚±ãƒƒãƒˆ">
      <span>ãƒã‚±ãƒƒãƒˆ</span>
    </div>
    <div class="tab" data-tab="collection">
      <img src="https://kkkkame0721.github.io/demoApp/icon/collection.svg" alt="ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³">
      <span>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</span>
    </div>
  </div>

<script>
  const pages = document.querySelectorAll('.page');
  const cards = [];
  const scrollArea = document.getElementById('scrollArea');
  const modal = document.getElementById('modal');
  const modalContent = document.getElementById('modalContent');
  const backBtn = document.getElementById('backBtn');
  const closeBtn = document.getElementById('closeModal');
  const tabs = document.querySelectorAll('.tab');
  const collectionGrid = document.getElementById('collectionGrid');
  const DEFAULT_PAGE = "collection";
  let currentPage = document.getElementById(DEFAULT_PAGE);

  /* --- JSONãƒ‡ãƒ¼ã‚¿å–å¾— â†’ ã‚«ãƒ¼ãƒ‰è¦ç´ ç”Ÿæˆ --- */
  fetch('https://kkkkame0721.github.io/demoApp/data.json?ver='+Date.now())
    .then(res => res.json())
    .then(data => {
      data.forEach(item => {
        const card = document.createElement('div');
        const id = item.id;
        card.classList.add('card');
        card.innerHTML = `
          <video class="card-video" id=${item.id} playsinline muted>
            <source src=${item.video} type="video/mp4">
          </video>
          <div class="info">
            ${item.title}
            <br>
            ${item.date}
          </div>
        `;
        // å†ç”ŸãŒçµ‚ã‚ã£ãŸã‚‰æœ€åˆã«æˆ»ã™
        const v = card.querySelector(".card-video");
        v.addEventListener("ended", () => {
          animationReset(v);
        });
        
        scrollArea.appendChild(card);
        cards.push(card);
        
        // ã‚µãƒ ãƒã‚¤ãƒ«è¨­å®š
        const thumb = document.createElement('img');
        thumb.classList.add("thumbnail");
        thumb.src = item.thumbnail;
        thumb.dataset.thumbid = item.id;
        
        // ã‚µãƒ ãƒã‚¤ãƒ«ã‚¯ãƒªãƒƒã‚¯æ™‚ã®æŒ™å‹•ã‚’ç™»éŒ²
        thumb.addEventListener("click", e => {
          const targetId = e.target.dataset.thumbid;
          const targetIndex = data.findIndex(item => item.id === targetId);

          // å…¨ã¦ã®å‹•ç”»çŠ¶æ³ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‹ã‚‰scrollAreaã¸é·ç§»
          allCardVideoStop();
          showPage("scrollArea");

          // é·ç§»ãŒçµ‚ã‚ã£ãŸå¾Œã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’èª¿æ•´ã—ã€å†ç”Ÿ
          requestAnimationFrame(() => {
            const height = window.innerHeight;
            scrollArea.scrollTop = targetIndex * height;
            playVideo(targetId);
          });
        });
        
        collectionGrid.appendChild(thumb);
      });
    });
  
  /* --- ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡ --- */
  function updateVideoPlayback() {
    const scrollPos = scrollArea.scrollTop;
    const height = window.innerHeight;

    cards.forEach((card, index) => {
      const video = card.querySelector(".card-video");
      const offset = Math.abs(scrollPos - index * height);
      const progress = Math.min(offset / height, 1);

      // ã‚¹ã‚±ãƒ¼ãƒ« & é€æ˜åº¦
      card.style.transform = `scale(${1 - progress * 0.05})`;
      card.style.opacity = `${1 - progress * 0.3}`;

      // â˜… ç”»é¢ä¸­å¤®ã«ä¸€ç•ªè¿‘ã„ã‚«ãƒ¼ãƒ‰ã ã‘å†ç”Ÿã€ãã‚Œä»¥å¤–åœæ­¢
      if (offset < height * 0.4) {
        if (video.paused) {
          video.play();
        }
      } else {
        animationReset(video);
      }
    });
  }

  /* --- ã‚¹ãƒ¯ã‚¤ãƒ—é–¢é€£ --- */
  let startX = 0;
  scrollArea.addEventListener('touchstart', e => {
    startX = e.touches[0].clientX;
  });
  scrollArea.addEventListener('touchend', e => {
    const endX = e.changedTouches[0].clientX;
    const diff = endX - startX;
    // å·¦ã‚¹ãƒ¯ã‚¤ãƒ—â†’è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«é–‹ãã€å³ã‚¹ãƒ¯ã‚¤ãƒ—â†’ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
    if (startX > 300 && diff < -80) {
      openModal();
    } else if (startX < 100 && diff > 80) {
      showPage("collection");
    }
  });
  
  // ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã‚¹ãƒ¯ã‚¤ãƒ—ã§é–‰ã˜ã‚‹
  let modalStartX = 0;
  modal.addEventListener('touchstart', e => modalStartX = e.touches[0].clientX);
  modal.addEventListener('touchend', e => {
    const modalDiff = e.changedTouches[0].clientX - modalStartX;
    if (modalStartX < 100 && modalDiff > 80) {
      closeModal();
    }
  });
  // ãƒœã‚¿ãƒ³ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
  closeBtn.addEventListener('click', closeModal);

  // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãé–¢æ•°
  function openModal() {
    const activeCard = document.querySelector('.card.active');
    const index = Array.from(cards).indexOf(activeCard);
    modal.classList.add('open');
    backBtn.classList.remove("active");
  }
  // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹é–¢æ•°
  function closeModal() {
    modal.classList.remove('open');
    backBtn.classList.add("active");
  }
  
  
  /* --- è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆç³» --- */
  // å‹•ç”»ã®ãƒªã‚»ãƒƒãƒˆ
  function animationReset (v) {
    v.pause();
    v.currentTime = 0;
  }
  
  // å…¨ç¸¦å‹•ç”»ã®åœæ­¢
  function allCardVideoStop () {
    cards.forEach(card => {
      const video = card.querySelector(".card-video");
      animationReset(video);
    });
  }
  
  //ã€€å‹•ç”»ã®å†ç”Ÿ
  function playVideo (targetId) {
    const targetVideo = document.getElementById(targetId);
    targetVideo.play();
  }
  
  // ãƒã‚±ãƒƒãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæŠ¼ã™ã¨å§‹ã¾ã‚‹ï¼‰
  const ticketAnim = document.getElementById("ticketAnimation");
  ticketAnim.addEventListener("click", () => ticketAnim.play());
  ticketAnim.addEventListener("ended", () => {
    animationReset(ticketAnim);
  });
  
  //ã‚¿ãƒ–ãƒãƒ¼åˆ‡ã‚Šæ›¿ãˆå‡¦ç†
  function tabChange (tabName) {
    tabs.forEach(t => {
      const n = t.dataset.tab;
      const img = t.querySelector('img');
      if (n === tabName) {
        t.classList.add('active');
        img.src = `https://kkkkame0721.github.io/demoApp/icon/${n}_active.svg`;
      } else {
        t.classList.remove('active');
        img.src = `https://kkkkame0721.github.io/demoApp/icon/${n}.svg`;
      }
    });
  }
  
  //ã€€ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
  function slideAnimation (targetPage) {
    // æº–å‚™ï¼šé †ç•ªã‚’èª¿ã¹ã‚‹
    const tabOrder = ["home", "ticket", "collection", "scrollArea"];
    const currentIndex = tabOrder.indexOf(currentPage.id);
    const targetIndex = tabOrder.indexOf(targetPage.id);
    const isForward = targetIndex > currentIndex;
    
    // æº–å‚™ï¼šã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å·¦å¤– or å³å¤–ã«ç½®ã
    targetPage.classList.remove('left','right','active');
    targetPage.classList.add(isForward ? 'right' : 'left');
    // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾Œã«ã‚¯ãƒ©ã‚¹ã‚’æ¶ˆã™
    currentPage.addEventListener('transitionend', () => {
      currentPage.classList.remove('left', 'right');
    }, { once: true });

    // force reflowï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã«çŠ¶æ…‹ã‚’èªè­˜ã•ã›ã‚‹ï¼‰
    targetPage.offsetHeight;

    // ç¾åœ¨ãƒšãƒ¼ã‚¸ã‚’å‡ºã™
    currentPage.classList.remove('active');
    currentPage.classList.add(isForward ? 'left' : 'right');
    currentPage.offsetHeight;

    // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ä¸­å¤®ã«å…¥ã‚Œã‚‹
    targetPage.classList.remove('right','left');
    targetPage.classList.add('active');

    currentPage = targetPage;
  }
  
  // è¡¨ç¤ºç³»ã¾ã¨ã‚
  function displayUpdate (targetPage) {
    // ãƒ¢ãƒ¼ãƒ€ãƒ«ã€ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
    const titleBar = document.getElementById("titleBar");
    
    if (targetPage.id === "scrollArea") {
      titleBar.classList.add("hidden");
      modal.classList.remove("open","hidden");
      backBtn.classList.add("active");
    } else {
      titleBar.classList.remove("hidden");
      modal.classList.remove("open");
      modal.classList.add("hidden");
      backBtn.classList.remove("active");
    }
    
    // ãƒ›ãƒ¼ãƒ ä¸‹éƒ¨ç”»åƒã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
    document.getElementById("homeBottom").style.opacity = (targetPage.id === "home") ? 1 : 0;
    
    // ãƒã‚±ãƒƒãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒªã‚»ãƒƒãƒˆ
    if(targetPage.id !== "ticket") {
      animationReset(ticketAnim);
    }
  }

  /* --- ãƒšãƒ¼ã‚¸è¡¨ç¤ºå‡¦ç† --- */
  function showPage(tabName) {
    const targetPage = document.getElementById(tabName);
    
    // ã‚¿ãƒ–ãƒãƒ¼åˆ‡ã‚Šæ›¿ãˆ
    tabChange(tabName);
    
    // ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
    document.getElementById("pageTitle").textContent = targetPage.dataset.tabname;
    
    // è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
    displayUpdate(targetPage);
    
    // ã‚¿ãƒ–ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†
    // ã‚‚ã—ç§»å‹•å‰å¾ŒãŒåŒã˜ãƒšãƒ¼ã‚¸ãªã‚‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ç„¡è¦–ã™ã‚‹
    if (targetPage.id !== currentPage.id) slideAnimation(targetPage);
  }
  
  /* --- åˆæœŸåŒ– --- */
  function init () {
    /* --- é–¢æ•°ç™»éŒ²ç³» --- */
    
    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²
    scrollArea.addEventListener("scroll", updateVideoPlayback);
    
    // å‹•ç”»ã‚¯ãƒªãƒƒã‚¯ã§å†ç”Ÿ
    scrollArea.addEventListener("click", e => {
      const target = e.target;
      if(target.classList.contains("card-video")) {
        if(target.paused) {
          target.play();
        } else {
          target.pause();
        }
      }
    });
    
    // ã‚¿ãƒ–ã‚¢ã‚¤ã‚³ãƒ³ã«é–¢æ•°ã‚’ç™»éŒ²
    tabs.forEach(tab => {
      const name = tab.dataset.tab;
      tab.addEventListener('click', () => {
        showPage(name);
      });
    });

    // ãƒ›ãƒ¼ãƒ ä¸‹éƒ¨ç”»åƒ â†’ ãƒã‚±ãƒƒãƒˆãƒšãƒ¼ã‚¸ã¸
    document.getElementById("homeBottomToTicket").addEventListener("click", () => showPage("ticket"));

    // å‹•ç”»ãƒšãƒ¼ã‚¸ â† æˆ»ã‚‹
    backBtn.addEventListener('click', () => {
      showPage('collection');
    });
    
    /* --- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒšãƒ¼ã‚¸è¡¨ç¤º --- */
    const p = document.getElementById(DEFAULT_PAGE);
    p.classList.add("active");
    showPage(DEFAULT_PAGE);
    
    // ãƒ‡ãƒãƒƒã‚°ç”¨
    document.getElementById("modal-swipe-handle").addEventListener("click", openModal);
  }
  
  // ãƒ­ãƒ¼ãƒ‰æ™‚ã€åˆæœŸåŒ–å®Ÿè¡Œ
  document.addEventListener('DOMContentLoaded', () => {
    init();
  });
</script>
</body>
</html>
